# プレビューガイド

記事をプレビューする3つの方法と、それぞれの使い分けを解説します。

## 📋 目次

1. [プレビュー方法の比較](#プレビュー方法の比較)
2. [localhostプレビューサーバー](#localhostプレビューサーバー推奨)
3. [簡易HTMLプレビュー](#簡易htmlプレビュー)
4. [Jekyllプレビュー](#jekyllプレビュー本番環境)
5. [トラブルシューティング](#トラブルシューティング)

---

## プレビュー方法の比較

| 方法 | Ruby | 起動時間 | 記事一覧 | CSS適用 | 用途 |
|------|------|---------|---------|---------|------|
| **localhostサーバー** | 不要 | 即座 | ✅ | ✅ | 日常的なプレビュー |
| 簡易HTML | 不要 | 即座 | ❌ | ✅ | 1記事の確認 |
| Jekyll | 必要 | 遅い | ✅ | ✅ | 本番前の最終確認 |

**推奨:** 日常的には **localhostプレビューサーバー** を使用!

---

## localhostプレビューサーバー（推奨）

### 起動方法

```bash
# デフォルト: ポート8000
python3 scripts/serve_preview.py

# カスタムポート
python3 scripts/serve_preview.py --port 3000

# ブラウザを自動で開かない
python3 scripts/serve_preview.py --no-open
```

### 表示内容

#### トップページ

サーバーを起動すると、自動的にブラウザが開き、記事一覧ページが表示されます。

**表示される情報:**
- 📂 下書き記事の一覧
- 📄 公開済み記事の一覧
- 各記事のタイトル、日付、カテゴリ
- ファイル名

**レイアウト:**
```
┌──────────────────────────────────────────────┐
│ 📝 記事プレビューサーバー                      │
│ マッチングアプリアフィリエイト記事管理          │
│                                              │
│ 🌐 サーバー起動中: http://localhost:8000     │
│ 終了するには: Ctrl+C                         │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│ 📂 下書き (3件)                               │
├──────────────────────────────────────────────┤
│ ┌────────────────────────────────────────┐  │
│ │ Pairs完全ガイド｜20代男性が3ヶ月...    │  │
│ │ [レビュー] [真剣恋活] 2026-02-08       │  │
│ │ sample-article.md                      │  │
│ └────────────────────────────────────────┘  │
│                                              │
│ ┌────────────────────────────────────────┐  │
│ │ Tinder実体験レビュー                    │  │
│ │ [レビュー] [カジュアル] 2026-02-08     │  │
│ │ 2026-02-08-tinder-review.md            │  │
│ └────────────────────────────────────────┘  │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│ 📄 公開済み (1件)                             │
├──────────────────────────────────────────────┤
│ ┌────────────────────────────────────────┐  │
│ │ with（ウィズ）徹底レビュー              │  │
│ │ [レビュー] [恋活] 2026-02-07           │  │
│ │ 2026-02-07-with-review.md              │  │
│ └────────────────────────────────────────┘  │
└──────────────────────────────────────────────┘
```

#### 記事プレビューページ

記事をクリックすると、実際のスタイルが適用されたプレビューが表示されます。

**表示される情報:**
- プレビューモード表示
- 記事一覧に戻るリンク
- 記事タイトル
- メタ情報（日付、カテゴリ）
- 記事本文（実際のCSSスタイル適用）
- タグ

**レイアウト:**
```
┌──────────────────────────────────────────────┐
│ 📝 プレビューモード - localhost表示           │
│ ← 記事一覧に戻る                              │
└──────────────────────────────────────────────┘

2026-02-08 • [レビュー] [真剣恋活]

Pairs(ペアーズ)完全ガイド｜
20代男性が3ヶ月使った本音レビュー

Pairs(ペアーズ)を実際に3ヶ月使ってみた感想を
本音でレビュー。料金、マッチング率、ユーザー層
など気になるポイントを徹底解説します。

────────────────────────────────────────

## はじめに

マッチングアプリ選びで迷っているあなたへ...

（記事本文が続く）

────────────────────────────────────────

タグ: #Pairs #マッチングアプリ #出会い #恋活
```

### 操作方法

#### 記事一覧の確認
1. ブラウザで http://localhost:8000 を開く
2. 下書きまたは公開済みセクションで記事を確認

#### 記事のプレビュー
1. 記事タイトルをクリック
2. 実際のスタイルで記事を確認
3. 「← 記事一覧に戻る」で戻る

#### サーバーの停止
- ターミナルで `Ctrl+C` を押す

### ファイル変更の反映

記事やCSSを編集した場合:

1. **記事を編集**: ブラウザをリロード (F5)
2. **CSSを編集**: ブラウザをリロード (F5)

**注意:** サーバーの再起動は不要です!

### ポート番号の変更

デフォルトのポート8000が使用中の場合:

```bash
# ポート3000で起動
python3 scripts/serve_preview.py --port 3000

# ブラウザで http://localhost:3000 を開く
```

---

## 簡易HTMLプレビュー

1記事だけを素早く確認したい場合に便利です。

### 使い方

```bash
python3 scripts/preview_html.py _drafts/sample-article.md
```

自動的にブラウザが開き、HTMLプレビューが表示されます。

### 特徴

- ✅ 超高速（サーバー不要）
- ✅ Ruby不要
- ✅ 基本的なMarkdown表示
- ❌ 記事一覧なし
- ❌ 実際のCSSは部分的に適用

### 生成されるファイル

```
/tmp/sample-article_preview.html
```

手動でブラウザを開く:
```bash
file:///tmp/sample-article_preview.html
```

---

## Jekyllプレビュー（本番環境）

本番と完全に同じ環境でプレビューします。

### 前提条件

Ruby と Jekyll のインストールが必要:

```bash
# Rubyのインストール
sudo apt install ruby-full  # Ubuntu/Debian
brew install ruby           # macOS

# Jekyll のインストール
gem install bundler jekyll
bundle install
```

### 使い方

```bash
python3 scripts/preview.py
```

または直接Jekyllコマンド:
```bash
bundle exec jekyll serve --drafts
```

### アクセス

ブラウザで http://localhost:4000 を開く

### 特徴

- ✅ 本番環境と完全に同じ
- ✅ すべての機能が動作
- ✅ プラグインも適用
- ❌ Ruby環境が必要
- ❌ 起動が遅い（初回ビルドに時間がかかる）

### 停止方法

ターミナルで `Ctrl+C` を押す

---

## 使い分けガイド

### 日常的な開発

**localhostプレビューサーバー** を使用:

```bash
python3 scripts/serve_preview.py
```

**理由:**
- Ruby不要
- 即座に起動
- 記事一覧が便利
- 実際のCSSが適用される

### 1記事の確認

**簡易HTMLプレビュー** を使用:

```bash
python3 scripts/preview_html.py _drafts/article.md
```

**理由:**
- 最速
- サーバー不要
- 一時的な確認に最適

### 本番前の最終確認

**Jekyllプレビュー** を使用:

```bash
python3 scripts/preview.py
```

**理由:**
- 本番環境と完全に同じ
- プラグインや機能がすべて動作
- 公開前の最終チェックに最適

---

## ワークフロー例

### 記事作成時

```bash
# 1. 記事を生成
python3 scripts/generate_article.py --type review --app Tinder

# 2. プレビューサーバーを起動
python3 scripts/serve_preview.py

# 3. ブラウザで確認しながら編集
# エディタで _drafts/2026-02-08-tinder-review.md を編集
# ブラウザをリロード (F5) で変更を確認

# 4. SEO検証
python3 scripts/seo_optimizer.py _drafts/2026-02-08-tinder-review.md

# 5. 公開
python3 scripts/publish.py _drafts/2026-02-08-tinder-review.md
```

### CSS調整時

```bash
# 1. プレビューサーバーを起動
python3 scripts/serve_preview.py

# 2. CSSを編集
nano assets/css/main.css

# 3. ブラウザをリロード (F5) で確認

# 4. 繰り返す（サーバーの再起動不要）
```

---

## トラブルシューティング

### ポートが使用中

**エラー:**
```
❌ エラー: ポート 8000 は既に使用されています
```

**解決方法:**
```bash
# 別のポートを使用
python3 scripts/serve_preview.py --port 3000
```

### ブラウザが開かない

**解決方法1: 手動で開く**
```
http://localhost:8000
```

**解決方法2: 自動オープン無効**
```bash
python3 scripts/serve_preview.py --no-open
```

### CSSが適用されない

**確認事項:**
1. `assets/css/main.css` が存在するか
2. ファイルのパスが正しいか
3. ブラウザのキャッシュをクリア (Ctrl+Shift+R)

### 記事が表示されない

**確認事項:**
1. `_drafts/` または `_posts/` にファイルがあるか
2. ファイルの拡張子が `.md` か
3. Front matterが正しい形式か

**Front matterの例:**
```yaml
---
title: "記事タイトル"
description: "説明文"
date: 2026-02-08
categories: [レビュー]
tags: [Pairs]
---
```

### サーバーが停止しない

**強制停止:**
```bash
# Ctrl+C を複数回押す

# それでも停止しない場合
# 別のターミナルで:
pkill -f serve_preview.py
```

---

## 高度な使い方

### 複数デバイスで確認

同じネットワーク上の他のデバイス（スマホなど）でプレビュー:

```bash
# IPアドレスを確認
hostname -I

# サーバーを起動
python3 scripts/serve_preview.py

# スマホのブラウザで:
# http://<IPアドレス>:8000
# 例: http://192.168.1.100:8000
```

### カスタムスタイルのテスト

独自のCSSを試す:

1. `assets/css/main.css` をバックアップ
2. 新しいスタイルを追加・編集
3. ブラウザをリロードして確認
4. 気に入らなければ元に戻す

---

## まとめ

プレビュー方法の選び方:

| 状況 | 推奨方法 |
|------|---------|
| 日常的な開発 | localhostプレビューサーバー |
| 1記事の確認 | 簡易HTMLプレビュー |
| 本番前の確認 | Jekyllプレビュー |
| CSS調整 | localhostプレビューサーバー |
| スマホで確認 | localhostプレビューサーバー |

**迷ったら:** `python3 scripts/serve_preview.py` を使いましょう!
